<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ø³Ø§Ø¨Ù‚Ø© Ø¹Ø±Ø¨ÙŠØ© - ØµÙ Ø±Ø§Ø¨Ø¹</title>
  <style>
    :root{
      --bg:#f7fafc;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#475569;
      --accent:#2563eb;
      --ok:#16a34a;
      --bad:#dc2626;
      --shadow:0 10px 30px rgba(0,0,0,.08);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: "Tajawal", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Kufi Arabic", Arial, sans-serif;
      background:linear-gradient(120deg,#eef2ff,#f8fafc);
      color:var(--text);
      min-height:100dvh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .app{
      width:min(980px,100%);
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
      border:1px solid #e5e7eb;
    }
    header{
      padding:18px 20px;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:10px 16px;
      background:#f8fafc;
      border-bottom:1px solid #e5e7eb;
    }
    .title{
      font-weight:800;
      font-size:clamp(18px,3vw,24px);
      letter-spacing:.2px;
    }
    .pill{
      margin-inline-start:auto;
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:700;
    }
    .pill > div{
      background:#fff;
      border:1px solid #e2e8f0;
      padding:8px 12px;
      border-radius:12px;
      box-shadow:var(--shadow);
    }
    .view{ padding:28px; }
    .card{
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:16px;
      padding:22px;
      box-shadow:var(--shadow);
    }
    .qno{
      color:var(--muted);
      font-weight:700;
      margin-bottom:8px;
    }
    .question{
      font-size:clamp(20px,3.6vw,28px);
      font-weight:800;
      line-height:1.4;
      margin:6px 0 18px;
    }
    .options{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:12px;
    }
    .btn{
      font:inherit;
      background:#fff;
      border:2px solid #e5e7eb;
      padding:14px 16px;
      border-radius:14px;
      cursor:pointer;
      text-align:center;
      font-weight:800;
      transition:transform .08s ease, box-shadow .2s ease, border-color .2s ease;
      box-shadow:0 4px 16px rgba(0,0,0,.06);
      user-select:none;
    }
    .btn:hover{ transform:translateY(-1px); }
    .btn:disabled{ opacity:.55; cursor:not-allowed; }
    .btn.primary{
      background:var(--accent);
      color:#fff;
      border-color:transparent;
    }
    .row{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .grow{ flex:1 1 auto; }
    .meta{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      color:var(--muted);
      font-weight:700;
    }
    .badge{
      background:#f1f5f9;
      border:1px solid #e2e8f0;
      padding:8px 12px;
      border-radius:999px;
    }
    .score{ color:var(--accent); font-weight:900; }
    .flash{
      animation:blink 1s ease-in-out 1;
    }
    @keyframes blink{
      0%,100%{ box-shadow:0 0 0 0 rgba(0,0,0,0) }
      25%,75%{ box-shadow:0 0 0 8px rgba(22,163,74,.15) }
      50%{ box-shadow:0 0 0 10px rgba(22,163,74,.28) }
    }
    .wrong{
      animation:blink-red 1s ease-in-out 1;
    }
    @keyframes blink-red{
      0%,100%{ box-shadow:0 0 0 0 rgba(0,0,0,0) }
      25%,75%{ box-shadow:0 0 0 8px rgba(220,38,38,.15) }
      50%{ box-shadow:0 0 0 10px rgba(220,38,38,.28) }
    }
    .progress{
      height:10px;
      background:#e2e8f0;
      border-radius:999px;
      overflow:hidden;
      position:relative;
      margin:14px 0 0;
    }
    .bar{
      position:absolute; inset:0;
      width:100%;
      transform-origin:right center;
      background:linear-gradient(90deg,#22c55e,#eab308,#f97316,#ef4444);
      transform:scaleX(1);
    }
    footer{
      display:flex; justify-content:space-between; align-items:center;
      padding:16px 22px; border-top:1px solid #e5e7eb; background:#fafafa;
    }
    .muted{ color:var(--muted) }
    .big{ font-size:clamp(18px,3vw,22px); font-weight:900 }
    .hidden{ display:none !important }
    .hint{ font-weight:700; color:#0f766e }
    .sep{ height:1px; background:#e5e7eb; margin:16px 0 }
    .center{ text-align:center }
  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <div class="title">Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© â€¢ Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹</div>
      <div class="pill">
        <div>Ø§Ù„Ù†Ù‚Ø§Ø·: <span class="score" id="score">0</span></div>
        <div>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ: <span id="best">0</span></div>
        <div>Ø§Ù„Ø³Ø¤Ø§Ù„: <span id="qIndex">-</span>/<span id="qTotal">-</span></div>
      </div>
    </header>

    <div class="view">
      <div id="screen-intro" class="card">
        <div class="big">Ø£Ù‡Ù„Ø§Ù‹! Ù‡Ø°Ù‡ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø³Ø±ÙŠØ¹Ø© ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹.</div>
        <p class="muted">ØªØªÙƒÙˆÙ‘Ù† Ù…Ù† Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯. Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„ ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯ØŒ ÙˆØ¥Ø¬Ø§Ø¨ØªÙƒ Ø§Ù„ØµØ­ÙŠØ­Ø© ØªØ¹Ø·ÙŠÙƒ Ù†Ù‚Ø§Ø·Ù‹Ø§. Ø­Ø§ÙˆÙ„ ÙƒØ³Ø± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ! ğŸ¯</p>
        <ul class="muted" style="margin:0 0 14px 0; line-height:1.9">
          <li>Ø§Ù„Ù…Ø¯Ø© Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„: <b id="perQ">15</b> Ø«Ø§Ù†ÙŠØ©.</li>
          <li>Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©: +10 Ù†Ù‚Ø§Ø·. ØªØ®ÙÙŠØ¶ Ø§Ù„ØªÙ…Ø§Ø·Ù„ Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª â±ï¸.</li>
          <li>Ù„Ø§ ØªÙ‚Ù„Ù‚ØŒ ØªÙ†ØªÙ‚Ù„ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª.</li>
        </ul>
        <div class="row">
          <button class="btn primary" id="startBtn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
          <button class="btn" id="howBtn">ÙƒÙŠÙ ØªØ¹Ù…Ù„ØŸ</button>
          <div class="grow"></div>
          <button class="btn" id="resetBestBtn" title="Ø­Ø°Ù Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ">Ø­Ø°Ù Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ</button>
        </div>
        <div id="how" class="hidden">
          <div class="sep"></div>
          <div class="hint">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù„Ø¹Ø¨</div>
          <p class="muted">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµØ­ÙŠØ­. Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙŠØ¸Ù‡Ø± ÙˆÙ…ÙŠØ¶ Ø£Ø®Ø¶Ø± (Ø£Ùˆ Ø£Ø­Ù…Ø± Ù„Ù„Ø®Ø·Ø£) ÙˆÙŠØµØ¯Ø± ØµÙˆØª. Ø«Ù… Ù†Ù†ØªÙ‚Ù„ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ.</p>
        </div>
      </div>

      <div id="screen-quiz" class="card hidden" aria-live="polite">
        <div class="qno">Ø³Ø¤Ø§Ù„ <span id="qNum">1</span></div>
        <div class="question" id="questionText">â€”</div>
        <div class="options" id="options"></div>
        <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
        <footer>
          <div class="meta">
            <span class="badge">Ø§Ù„ÙˆÙ‚Øª: <b id="timeLeft">â€”</b> Ø«</span>
            <span class="badge">Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©: <b id="correctCount">0</b></span>
            <span class="badge">Ù…ØªØ¨Ù‚ÙŠ: <b id="remain">â€”</b></span>
          </div>
          <div class="muted">ØªÙ„Ù…ÙŠØ­: Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ùˆ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ (Ù¡-Ù¤).</div>
        </footer>
      </div>

      <div id="screen-end" class="card hidden center">
        <div class="big">Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©!</div>
        <p>Ù†ØªÙŠØ¬ØªÙƒ: <b id="finalScore">0</b> Ù†Ù‚Ø·Ø©.</p>
        <p>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ: <b id="finalBest">0</b></p>
        <div class="row center" style="justify-content:center">
          <button class="btn primary" id="againBtn">Ø§Ù„Ø¹Ø¨ Ù…Ø¬Ø¯Ø¯Ù‹Ø§</button>
          <button class="btn" id="shareBtn" title="Ø§Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©">Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Ø£ØµÙˆØ§Øª -->
  <audio id="s-correct" preload="auto">
    <source src="data:audio/wav;base64,UklGRqgAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAZGF0YQCgAAAAAAAAPwAAAP8AAP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A" type="audio/wav">
  </audio>
  <audio id="s-wrong" preload="auto">
    <source src="data:audio/wav;base64,UklGRqgAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAZGF0YQCgAAAAAAAAPwAAAP8AAP8A/wD/AAD/AAAA/wAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA" type="audio/wav">
  </audio>
  <audio id="s-tick" preload="auto">
    <source src="data:audio/wav;base64,UklGRkQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAZGF0YQBAAAAAAAAAPwAAAP8A" type="audio/wav">
  </audio>

  <script>
    // â€”â€”â€”â€”â€” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§) â€”â€”â€”â€”â€”
    const QUESTIONS = [
      {
        q: "Ù…Ø§ Ø¬Ù…Ø¹ ÙƒÙ„Ù…Ø© (ÙƒØªØ§Ø¨)ØŸ",
        options: ["ÙƒØªØ§Ø¦Ø¨", "ÙƒØªØ¨", "ÙƒØªØ§Ø¨Ø§Øª", "ÙƒØ§ØªØ¨ÙˆÙ†"],
        answer: 1
      },
      {
        q: "Ø£ÙŠÙÙ‘ Ø§Ù„Ø¬Ù…Ù„ ØµØ­ÙŠØ­Ø© Ø¥Ù…Ù„Ø§Ø¦ÙŠÙ‹Ø§ØŸ",
        options: ["Ø°Ù‡Ø¨ØªÙˆ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©", "Ø°Ù‡Ø¨ØªÙ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ù‡", "Ø°ÙÙ‡ÙØ¨ØªÙ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©", "Ø°Ù‡Ø¨Ù’ØªÙ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ù‡"],
        answer: 2
      },
      {
        q: "Ù…Ø±Ø§Ø¯Ù ÙƒÙ„Ù…Ø© (Ø³Ø¹ÙŠØ¯) Ù‡Ùˆ:",
        options: ["Ø­Ø²ÙŠÙ†", "ÙØ±Ø­", "Ù‚ØµÙŠØ±", "Ø³Ø±ÙŠØ¹"],
        answer: 1
      },
      {
        q: "Ù…Ø¤Ù†Ø« ÙƒÙ„Ù…Ø© (Ø·Ø§Ù„Ø¨) Ù‡Ùˆ:",
        options: ["Ø·Ø§Ù„Ø¨Ø©", "Ø·Ø§Ù„Ø¨Ø§Øª", "Ø·Ø§Ù„Ø¨ÙˆÙ†", "Ø·Ù„Ø¨"],
        answer: 0
      },
      {
        q: "Ù…ÙØ±Ø¯ (Ø£ØµØ¯Ù‚Ø§Ø¡) Ù‡Ùˆ:",
        options: ["ØµØ¯ÙŠÙ‚", "ØµØ¯Ù‚Ø©", "ØµÙØ¯ÙˆÙ‚", "ØµØ¯Ø§Ù‚Ø©"],
        answer: 0
      },
      {
        q: "Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªØ§Ø¡ Ù…Ø±Ø¨ÙˆØ·Ø©:",
        options: ["Ø­Ø¯ÙŠÙ‚Ù€Ù‡", "Ù…Ø¯Ø±Ø³Ø©", "Ø¨ÙŠØª", "ÙƒØªØ§Ø¨"],
        answer: 1
      },
      {
        q: "Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø¶Ø§Ø¯Ù‘Ø© Ù„Ù€ (Ù‚ÙˆÙŠ):",
        options: ["Ø´Ø¬Ø§Ø¹", "Ø¶Ø¹ÙŠÙ", "Ø³Ø±ÙŠØ¹", "Ù„Ø·ÙŠÙ"],
        answer: 1
      },
      {
        q: "Ù†ÙˆØ¹ Ø§Ù„ØªÙ†ÙˆÙŠÙ† ÙÙŠ ÙƒÙ„Ù…Ø© (ÙƒØªØ§Ø¨Ù‹Ø§):",
        options: ["ØªÙ†ÙˆÙŠÙ† Ø¶Ù…", "ØªÙ†ÙˆÙŠÙ† ÙƒØ³Ø±", "ØªÙ†ÙˆÙŠÙ† ÙØªØ­", "Ø¨Ø¯ÙˆÙ† ØªÙ†ÙˆÙŠÙ†"],
        answer: 2
      },
      {
        q: "Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø§Ø³ØªÙÙ‡Ø§Ù… ØªÙÙƒØªØ¨:",
        options: ["ØŒ", "Ø›", "ØŸ", "!"],
        answer: 2
      },
      {
        q: "Ø¶Ø¯ ÙƒÙ„Ù…Ø© (Ø¨Ø¹ÙŠØ¯):",
        options: ["Ø·ÙˆÙŠÙ„", "Ù‚Ø±ÙŠØ¨", "Ù‚ØµÙŠØ±", "Ø¹Ù…ÙŠÙ‚"],
        answer: 1
      }
    ];

    // â€”â€”â€”â€”â€” Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª â€”â€”â€”â€”â€”
    const SECONDS_PER_QUESTION = 15;
    const POINTS_PER_QUESTION = 10;

    // â€”â€”â€”â€”â€” Ø§Ù„Ø­Ø§Ù„Ø© â€”â€”â€”â€”â€”
    let index = 0;
    let score = 0;
    let correct = 0;
    let timerId = null;
    let timeLeft = SECONDS_PER_QUESTION;
    let locked = false;

    // â€”â€”â€”â€”â€” Ø¹Ù†Ø§ØµØ± DOM â€”â€”â€”â€”â€”
    const screenIntro = document.getElementById("screen-intro");
    const screenQuiz  = document.getElementById("screen-quiz");
    const screenEnd   = document.getElementById("screen-end");
    const startBtn = document.getElementById("startBtn");
    const howBtn = document.getElementById("howBtn");
    const howBox = document.getElementById("how");
    const resetBestBtn = document.getElementById("resetBestBtn");

    const questionText = document.getElementById("questionText");
    const optionsBox = document.getElementById("options");
    const qNum = document.getElementById("qNum");
    const qIndex = document.getElementById("qIndex");
    const qTotal = document.getElementById("qTotal");
    const timeLeftEl = document.getElementById("timeLeft");
    const bar = document.getElementById("bar");
    const scoreEl = document.getElementById("score");
    const correctCountEl = document.getElementById("correctCount");
    const remainEl = document.getElementById("remain");

    const finalScore = document.getElementById("finalScore");
    const finalBest = document.getElementById("finalBest");
    const againBtn = document.getElementById("againBtn");
    const shareBtn = document.getElementById("shareBtn");

    const bestEl = document.getElementById("best");

    // â€”â€”â€”â€”â€” Ø£ØµÙˆØ§Øª â€”â€”â€”â€”â€”
    const sCorrect = document.getElementById("s-correct");
    const sWrong = document.getElementById("s-wrong");
    const sTick = document.getElementById("s-tick");

    // â€”â€”â€”â€”â€” ØªØ®Ø²ÙŠÙ† â€”â€”â€”â€”â€”
    const BEST_KEY = "arabic_quiz_best_v1";

    function getBest(){
      const v = Number(localStorage.getItem(BEST_KEY) || 0);
      return isNaN(v) ? 0 : v;
    }
    function setBest(v){
      localStorage.setItem(BEST_KEY, String(v));
    }

    // â€”â€”â€”â€”â€” Ø£Ø¯ÙˆØ§Øª â€”â€”â€”â€”â€”
    function byebyeTimers(){
      if (timerId) { clearInterval(timerId); timerId = null; }
    }
    function setScreen(name){
      screenIntro.classList.add("hidden");
      screenQuiz.classList.add("hidden");
      screenEnd.classList.add("hidden");
      if(name==="intro") screenIntro.classList.remove("hidden");
      if(name==="quiz")  screenQuiz.classList.remove("hidden");
      if(name==="end")   screenEnd.classList.remove("hidden");
    }
    function play(el){
      try{ el.currentTime = 0; el.play(); }catch(e){}
    }
    function formatTwo(n){ return n<10 ? "0"+n : ""+n; }

    // â€”â€”â€”â€”â€” ØªØ´ØºÙŠÙ„ â€”â€”â€”â€”â€”
    function start(){
      index = 0;
      score = 0;
      correct = 0;
      scoreEl.textContent = "0";
      correctCountEl.textContent = "0";
      bestEl.textContent = getBest();
      qTotal.textContent = QUESTIONS.length;
      perQ.textContent = SECONDS_PER_QUESTION;
      setScreen("quiz");
      loadQuestion();
    }

    function loadQuestion(){
      byebyeTimers();
      locked = false;
      const q = QUESTIONS[index];
      qNum.textContent = index + 1;
      qIndex.textContent = index + 1;
      questionText.textContent = q.q;
      optionsBox.innerHTML = "";
      q.options.forEach((opt, i)=>{
        const b = document.createElement("button");
        b.className = "btn";
        b.type = "button";
        b.textContent = opt;
        b.dataset.i = i;
        b.addEventListener("click", ()=> choose(i, b));
        optionsBox.appendChild(b);
      });
      timeLeft = SECONDS_PER_QUESTION;
      updateMeta();
      runTimer();
    }

    function updateMeta(){
      timeLeftEl.textContent = timeLeft;
      remainEl.textContent = (QUESTIONS.length - index - 1);
      // ØªÙ‚Ø¯Ù… Ø§Ù„Ø´Ø±ÙŠØ·
      const ratio = Math.max(0, Math.min(1, timeLeft / SECONDS_PER_QUESTION));
      bar.style.transform = `scaleX(${ratio})`;
      bar.style.transformOrigin = "right center";
    }

    function choose(i, btnEl){
      if(locked) return;
      locked = true;
      byebyeTimers();
      const q = QUESTIONS[index];
      const all = [...optionsBox.querySelectorAll("button")];
      all.forEach(b=> b.disabled = true);
      if(i === q.answer){
        // Ù†Ù‚Ø§Ø· ØªØªÙ†Ø§Ù‚Øµ Ù‚Ù„ÙŠÙ„Ù‹Ø§ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªÙ‡Ù„Ùƒ
        const timeRatio = timeLeft / SECONDS_PER_QUESTION;
        const gained = Math.max(5, Math.round(POINTS_PER_QUESTION * (0.6 + 0.4 * timeRatio)));
        score += gained;
        correct += 1;
        scoreEl.textContent = score;
        correctCountEl.textContent = correct;
        btnEl.classList.add("flash");
        play(sCorrect);
      }else{
        btnEl.classList.add("wrong");
        // ØªØ£Ø´ÙŠØ± Ø§Ù„ØµØ­ÙŠØ­
        const rightBtn = optionsBox.querySelector(`button[data-i="${q.answer}"]`);
        rightBtn && rightBtn.classList.add("flash");
        play(sWrong);
      }
      // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¹Ø¯ ÙˆÙ…Ø¶Ø©
      setTimeout(next, 900);
    }

    function next(){
      index++;
      if(index >= QUESTIONS.length){
        endGame();
      }else{
        loadQuestion();
      }
    }

    function endGame(){
      setScreen("end");
      finalScore.textContent = score;
      const best = getBest();
      if(score > best){
        setBest(score);
        bestEl.textContent = score;
        finalBest.textContent = score + " (Ø¬Ø¯ÙŠØ¯!)";
      }else{
        finalBest.textContent = best;
      }
    }

    function runTimer(){
      updateMeta();
      byebyeTimers();
      timerId = setInterval(()=>{
        timeLeft--;
        // ØµÙˆØª Ø®ÙÙŠÙ Ø¢Ø®Ø± 5 Ø«ÙˆØ§Ù†Ù
        if(timeLeft <= 5 && timeLeft > 0){
          play(sTick);
        }
        if(timeLeft <= 0){
          byebyeTimers();
          // ÙƒØ£Ù†Ù‡Ø§ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø®ØªÙŠØ§Ø±
          const fake = document.createElement("button");
          fake.dataset.i = -1;
          choose(-1, fake);
          return;
        }
        updateMeta();
      }, 1000);
    }

    // â€”â€”â€”â€”â€” Ø£Ø­Ø¯Ø§Ø« Ø¹Ø§Ù…Ø© â€”â€”â€”â€”â€”
    startBtn.addEventListener("click", start);
    howBtn.addEventListener("click", ()=> howBox.classList.toggle("hidden"));
    resetBestBtn.addEventListener("click", ()=>{
      localStorage.removeItem(BEST_KEY);
      bestEl.textContent = "0";
    });
    againBtn.addEventListener("click", ()=>{
      setScreen("intro");
    });
    shareBtn.addEventListener("click", ()=>{
      const txt = `Ù†ØªÙŠØ¬ØªÙŠ ÙÙŠ Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©: ${score} Ù†Ù‚Ø·Ø© Ù…Ù† ${QUESTIONS.length * POINTS_PER_QUESTION}. Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${getBest()}.`;
      if(navigator.clipboard){ navigator.clipboard.writeText(txt); }
      alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©!");
    });

    // Ø£Ø±Ù‚Ø§Ù… Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ 1-4 Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©/Ø§Ù„Ù„Ø§ØªÙŠÙ†ÙŠØ©
    window.addEventListener("keydown", (e)=>{
      const map = { "1":0,"2":1,"3":2,"4":3, "Ù¡":0,"Ù¢":1,"Ù£":2,"Ù¤":3 };
      if(screenQuiz.classList.contains("hidden")) return;
      const v = map[e.key];
      if(v !== undefined){
        const btn = optionsBox.querySelector(`button[data-i="${v}"]`);
        if(btn) choose(v, btn);
      }
    });

    // ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ÙŠØ©
    const perQ = document.getElementById("perQ");
    bestEl.textContent = getBest();
    qTotal.textContent = QUESTIONS.length;
    qIndex.textContent = 0;
  </script>
</body>
</html>
