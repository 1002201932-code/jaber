<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø§Ù„Ø¹ÙˆØ¯ â€“ Ø¯Ø±Ø³ ØªÙØ§Ø¹Ù„ÙŠ</title>
  <style>
    :root{
      --bg:#f7f9fc;--card:#ffffff;--ink:#0f172a;--muted:#475569;--accent:#16a34a;--danger:#dc2626;--ring:#cbd5e1;
    }
    html,body{margin:0;height:100%;font-family:"Tajawal","Cairo","Noto Naskh Arabic",system-ui;-webkit-font-smoothing:antialiased;background:var(--bg);color:var(--ink)}
    .wrap{max-width:980px;margin:auto;padding:24px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:18px}
    header h1{margin:0;font-size:clamp(22px,3.6vw,36px)}
    header .small{color:var(--muted);font-size:14px}
    .card{background:var(--card);border:1px solid var(--ring);border-radius:18px;box-shadow:0 6px 24px rgba(15,23,42,.06);padding:18px;margin:14px 0}
    .text{line-height:2.1;font-size:20px}
    .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    button, .btn{cursor:pointer;border:1px solid var(--ring);background:#fff;border-radius:12px;padding:10px 14px;font-size:16px}
    button:hover{background:#f1f5f9}
    .accent{border-color:#22c55e}
    .danger{border-color:#ef4444}
    .ok{color:#065f46}
    .no{color:#b91c1c}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
    .q{padding:14px;border-radius:14px;border:1px dashed #d1d5db;background:#fff}
    .q h3{margin:0 0 8px 0;font-size:18px}
    .choices{display:grid;gap:8px}
    .choices label{border:1px solid #e5e7eb;border-radius:12px;padding:8px 10px;display:flex;align-items:center;gap:8px}
    .choices input{accent-color:#16a34a}
    .feedback{min-height:22px;font-weight:700}
    .right{color:var(--accent)}
    .wrong{color:var(--danger)}
    .fill input{width:100%;padding:10px;border-radius:10px;border:1px solid #cbd5e1;font-size:16px}
    .hl{background:#fff8dc;padding:2px 6px;border-radius:8px}
    .muted{color:var(--muted)}
    .footer{display:flex;gap:10px;justify-content:space-between;flex-wrap:wrap}
    .score{font-size:18px}
    .badge{background:#eef2ff;border:1px solid #c7d2fe;border-radius:999px;padding:4px 10px}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;border:1px solid #cbd5e1;border-bottom-width:3px;border-radius:8px;padding:0 6px}
    /* accessibility */
    button:focus, input:focus{outline:3px solid #93c5fd;outline-offset:2px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Ø§Ù„Ø¹ÙˆØ¯ â€“ Ø¯Ø±Ø³ ØªÙØ§Ø¹Ù„ÙŠ Ù„Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</h1>
      <div class="small">Ø§Ø¶ØºØ· <span class="kbd">Ctrl</span> + <span class="kbd">+</span> Ù„Ù„ØªÙƒØ¨ÙŠØ±</div>
    </header>

    <section class="card">
      <div class="controls">
        <button id="ttsBtn" class="accent">ğŸ”Š Ø§Ø³ØªÙ…Ø¹ Ø¥Ù„Ù‰ Ø§Ù„Ù†Øµ</button>
        <button id="vowelsBtn">Ø¥Ø®ÙØ§Ø¡/Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ´ÙƒÙŠÙ„</button>
        <button id="printBtn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØµÙØ­Ø©</button>
      </div>
      <article id="text" class="text" aria-label="Ø§Ù„Ù†Øµ">
        <h2 style="margin:8px 0 12px 0">Ø§Ù„Ù†Ù‘ÙØµÙ‘Ù</h2>
        <p>
          <span class="hl">Ø§ÙØ³Ù’Ù…ÙÙ‡Ù Ø§Ù„Ø¹ÙÙˆØ¯Ù</span>ØŒ ÙˆÙ‡ÙˆÙ <strong>Ø³ÙÙ„Ø·Ø§Ù†Ù Ø§Ù„Ù…ÙÙˆØ³ÙÙŠÙ‚ÙÙ‰ Ø§Ù„Ø¹ÙØ±ÙØ¨ÙÙŠÙ‘ÙØ©Ù</strong>.
          Ø¸ÙÙ‡ÙØ±ÙØªÙ’ Ù‡Ø°ÙÙ‡Ù Ø§Ù„Ø¢Ù„ÙØ©Ù Ø§Ù„Ù…ÙÙˆØ³ÙÙŠÙ‚ÙÙŠÙ‘ÙØ©Ù Ø³ÙÙ†ÙØ©Ù <strong>Ù¡Ù¦Ù Ù  Ù‚ÙØ¨Ù’Ù„Ù Ø§Ù„Ù…ÙÙŠÙ„Ø§Ø¯Ù</strong>
          Ø¹ÙÙ†Ù’Ø¯Ù Ø§Ù„Ø¨ÙØ§Ø¨ÙÙ„ÙÙŠÙ‘ÙÙŠÙ†ÙØŒ ÙˆØ¨ÙØ¹Ù’Ø¯Ù Ù…ÙØ§Ø¦ÙØ©Ù Ø³ÙÙ†ÙØ©Ù ÙÙŠ Ù…ÙØµÙ’Ø±Ù Ø§Ù„Ù‚ÙØ¯ÙÙŠÙ…ÙØ©Ù Ø£ÙÙŠÙ’Ø¶Ù‹Ø§.
          ØªÙØ¹ÙØ±Ù‘ÙÙÙØªÙ’ Ø£ÙÙˆØ±ÙÙˆØ¨Ù‘ÙØ§ Ø¹ÙÙ„ÙÙ‰ Ù‡Ø°ÙÙ‡Ù Ø§Ù„Ø¢Ù„ÙØ©Ù Ø¹ÙÙ†Ù’Ø¯ÙÙ…ÙØ§ ÙˆÙØµÙÙ„Ù Ø§Ù„Ø¹ÙØ±ÙØ¨Ù
          Ø¥ÙÙ„Ù‰ Ø¥ÙØ³Ù’Ø¨ÙØ§Ù†Ù’ÙŠÙØ§ Ø³ÙÙ†ÙØ©Ù <strong>Ù§Ù¡Ù  Ù„ÙÙ„Ù…ÙÙŠÙ„Ø§Ø¯Ù</strong>.
          ÙƒÙÙ„ÙÙ…ÙØ©Ù Â«Ø¹ÙÙˆØ¯Â» ØªÙØ¹Ù’Ù†ÙÙŠ <em>Ø§Ù„Ø®ÙØ´ÙØ¨Ù</em>ØŒ ÙˆÙŠÙÙ‚ÙØ§Ù„Ù Ø¥ÙÙ†Ù‘Ù Ø§Ù„Ø¹ÙÙˆØ¯Ù Ù‡ÙÙˆÙ Ø·ÙÙŠØ¨Ù Ø§Ù„Ù†Ù‘ÙÙÙ’Ø³Ù ÙˆÙØ§Ù„Ø±Ù‘ÙÙˆØ­Ù.
        </p>
      </article>
    </section>

    <section class="card">
      <h2 style="margin-top:0">ÙÙÙ‡Ù’Ù…Ù Ø§Ù„Ù…ÙÙ‚Ù’Ø±ÙÙˆØ¡ â€“ Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</h2>
      <div class="grid" id="mcq"></div>
    </section>

    <section class="card">
      <h2 style="margin-top:0">Ø£ÙƒÙ…Ù„ Ø§Ù„ÙØ±Ø§Øº</h2>
      <div class="grid" id="fills"></div>
    </section>

    <section class="card">
      <h2 style="margin-top:0">Ù†Ø´Ø§Ø· Ø³Ø±ÙŠØ¹</h2>
      <p class="muted">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†Øµ:</p>
      <div class="controls">
        <button data-find="Ø§Ù„Ø®ÙØ´ÙØ¨Ù">Ø§Ø¨Ø­Ø« Ø¹Ù†: Ø§Ù„Ø®Ø´Ø¨</button>
        <button data-find="Ø³ÙÙ„Ø·Ø§Ù†Ù">Ø§Ø¨Ø­Ø« Ø¹Ù†: Ø³Ù„Ø·Ø§Ù†</button>
        <button data-find="Ù§Ù¡Ù ">Ø§Ø¨Ø­Ø« Ø¹Ù†: Ù§Ù¡Ù </button>
      </div>
      <p id="findMsg" class="feedback"></p>
    </section>

    <section class="card footer">
      <div class="score">Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="score">0</span> / <span id="total">0</span> <span id="badge" class="badge" style="display:none"></span></div>
      <div class="controls">
        <button id="checkAll" class="accent">ØªØ­Ù‚Ù‘ÙÙ‚ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</button>
        <button id="reset" class="danger">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
      </div>
    </section>

  </div>

  <script>
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
    const mcqData = [
      {
        q: "Ù…Ø§ Ù„ÙÙ‚ÙØ¨Ù Ø¢Ù„Ø©Ù Ø§Ù„Ø¹ÙˆØ¯Ù ÙÙŠ Ø§Ù„Ù†Ù‘ÙØµØŸ",
        choices: ["Ø£Ù…ÙŠØ± Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©","Ø³ÙÙ„Ø·Ø§Ù†Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©","Ù…Ù„Ùƒ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ø¹"],
        answer: 1
      },
      {
        q: "Ù…ØªÙ‰ ØªÙØ¹Ø±Ù‘ÙÙØª Ø£ÙˆØ±ÙˆØ¨Ø§ Ø¹Ù„Ù‰ Ø¢Ù„Ø© Ø§Ù„Ø¹ÙˆØ¯ØŸ",
        choices: ["Ø³Ù†Ø© Ù§Ù¡Ù  Ù„Ù„Ù…ÙŠÙ„Ø§Ø¯","Ø³Ù†Ø© Ù¡Ù¦Ù Ù  Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯","Ø³Ù†Ø© Ù¡Ù Ù  Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯"],
        answer: 0
      },
      {
        q: "ÙƒÙ„Ù…Ø©Ù Â«Ø¹ÙˆØ¯Â» Ù…Ø§Ø°Ø§ ØªØ¹Ù†ÙŠØŸ",
        choices: ["Ø§Ù„ÙˆØªØ±","Ø§Ù„Ø®ÙØ´ÙØ¨","Ø§Ù„Ù„Ø­Ù†"],
        answer: 1
      },
      {
        q: "Ø¹Ù†Ø¯ Ù…ÙÙ† Ø¸ÙÙ‡ÙØ±ÙØª Ø§Ù„Ø¢Ù„Ø©Ù Ø£ÙˆÙ‘Ù„Ù‹Ø§ Ø¨Ø­Ø³Ø¨ Ø§Ù„Ù†Ù‘ØµØŸ",
        choices: ["Ø§Ù„ÙŠÙˆÙ†Ø§Ù†ÙŠÙŠÙ†","Ø§Ù„Ø¨Ø§Ø¨Ù„ÙŠÙŠÙ†","Ø§Ù„Ù…ØµØ±ÙŠÙŠÙ†"],
        answer: 1
      }
    ];

    const fillData = [
      {q:"Ø§Ø³Ù…Ù‡ ______ ÙˆÙ‡Ùˆ Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.", a:"Ø§Ù„Ø¹ÙˆØ¯"},
      {q:"Ø¸Ù‡Ø±Øª Ù‡Ø°Ù‡ Ø§Ù„Ø¢Ù„Ø© Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚ÙŠØ© Ø³Ù†Ø© ______ Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯.", a:"Ù¡Ù¦Ù Ù "},
      {q:"ÙˆØµÙ„ Ø§Ù„Ø¹Ø±Ø¨ Ø¥Ù„Ù‰ Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§ Ø³Ù†Ø© ______ Ù„Ù„Ù…ÙŠÙ„Ø§Ø¯.", a:"Ù§Ù¡Ù "},
      {q:"ÙƒÙ„Ù…Ø© Ø¹ÙˆØ¯ ØªØ¹Ù†ÙŠ ______.", a:"Ø§Ù„Ø®Ø´Ø¨"}
    ];

    const grid = document.getElementById('mcq');
    const fills = document.getElementById('fills');
    const totalEl = document.getElementById('total');
    const scoreEl = document.getElementById('score');

    // Ø¨Ù†Ø§Ø¡ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯
    mcqData.forEach((item, idx)=>{
      const box = document.createElement('div');
      box.className = 'q';
      box.innerHTML = `<h3>${idx+1}. ${item.q}</h3>
        <div class="choices">
          ${item.choices.map((c,i)=>`<label><input type="radio" name="mcq${idx}" value="${i}"> ${c}</label>`).join('')}
        </div>
        <div class="feedback" id="fb-m${idx}"></div>`;
      grid.appendChild(box);
    });

    // Ø¨Ù†Ø§Ø¡ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„
    fillData.forEach((item, idx)=>{
      const box = document.createElement('div');
      box.className = 'q fill';
      box.innerHTML = `<h3>${idx+1}. ${item.q}</h3>
        <input id="fill${idx}" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù‡Ù†Ø§" aria-label="${item.q}">
        <div class="feedback" id="fb-f${idx}"></div>`;
      fills.appendChild(box);
    });

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹
    const totalQs = mcqData.length + fillData.length;
    totalEl.textContent = totalQs;

    function checkAll(){
      let score = 0;
      // ØªØ­Ù‚Ù‚ Ù…Ù† MCQ
      mcqData.forEach((item, idx)=>{
        const sel = document.querySelector(`input[name=mcq${idx}]:checked`);
        const fb = document.getElementById(`fb-m${idx}`);
        if(!sel){fb.textContent='Ø§Ø®ØªØ± Ø¥Ø¬Ø§Ø¨Ø©.';fb.className='feedback wrong';return;}
        const ok = Number(sel.value) === item.answer;
        fb.textContent = ok ? 'âœ” Ø£Ø­Ø³Ù†Øª!' : 'âœ˜ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
        fb.className = 'feedback ' + (ok?'right':'wrong');
        if(ok) score++;
      });
      // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙØ±Ø§ØºØ§Øª
      fillData.forEach((item, idx)=>{
        const input = document.getElementById(`fill${idx}`);
        const fb = document.getElementById(`fb-f${idx}`);
        const user = normalizeArabic(input.value);
        const correct = normalizeArabic(item.a);
        const ok = user && (user === correct);
        fb.textContent = ok ? 'âœ” ØµØ­ÙŠØ­' : 'âœ˜ ØºÙŠØ± ØµØ­ÙŠØ­';
        fb.className = 'feedback ' + (ok?'right':'wrong');
        input.style.borderColor = ok ? '#16a34a' : '#dc2626';
        if(ok) score++;
      });
      scoreEl.textContent = score;
      const badge = document.getElementById('badge');
      badge.style.display='inline-block';
      if(score === totalQs){badge.textContent='Ø§Ù…ØªÙŠØ§Ø²!';}
      else if(score >= totalQs-1){badge.textContent='Ø±Ø§Ø¦Ø¹!';}
      else if(score >= Math.ceil(totalQs*0.6)){badge.textContent='Ø¬ÙŠÙ‘Ø¯ Ø¬Ø¯Ù‹Ø§';}
      else {badge.textContent='ØªØ§Ø¨ÙØ¹ Ø§Ù„ØªØ¯Ø±Ù‘Ø¨';}
    }

    function resetAll(){
      document.querySelectorAll('input[type=radio]').forEach(r=>{r.checked=false});
      document.querySelectorAll('.feedback').forEach(f=>{f.textContent='';f.className='feedback'});
      document.querySelectorAll('.fill input').forEach(i=>{i.value='';i.style.borderColor='#cbd5e1'});
      scoreEl.textContent = '0';
      document.getElementById('badge').style.display='none';
    }

    document.getElementById('checkAll').addEventListener('click', checkAll);
    document.getElementById('reset').addEventListener('click', resetAll);

    // Ø¥Ø¨Ø±Ø§Ø² ÙƒÙ„Ù…Ø§Øª
    document.querySelectorAll('[data-find]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const word = btn.dataset.find;
        const area = document.getElementById('text');
        const msg = document.getElementById('findMsg');
        const range = document.createRange();
        const walker = document.createTreeWalker(area, NodeFilter.SHOW_TEXT, null);
        let foundNode = null, offset=0;
        while(walker.nextNode()){
          const t = walker.currentNode.nodeValue;
          const pos = t.indexOf(word);
          if(pos!==-1){foundNode = walker.currentNode; offset = pos; break;}
        }
        if(foundNode){
          range.setStart(foundNode, offset);
          range.setEnd(foundNode, offset + word.length);
          const sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(range);
          msg.textContent = 'ØªÙ…Ù‘ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„Ù…Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†Øµ';
          msg.className = 'feedback right';
        }else{
          msg.textContent = 'Ù„Ù… Ø£Ø¬Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø©.
';
          msg.className = 'feedback wrong';
        }
      });
    });

    // Ù†Ø·Ù‚ Ø§Ù„Ù†Øµ (ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù…ØªØµÙÙ‘Ø­ Ø§Ù„Ø·Ø§Ù„Ø¨)
    const ttsBtn = document.getElementById('ttsBtn');
    let speaking = false;
    ttsBtn.addEventListener('click', ()=>{
      if(!('speechSynthesis' in window)){
        alert('Ù…ÙŠØ²Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙÙ‘Ø­.');
        return;
      }
      const synth = window.speechSynthesis;
      if(speaking){ synth.cancel(); speaking=false; ttsBtn.textContent='ğŸ”Š Ø§Ø³ØªÙ…Ø¹ Ø¥Ù„Ù‰ Ø§Ù„Ù†Øµ'; return; }
      const utter = new SpeechSynthesisUtterance(document.getElementById('text').innerText.replace('Ø§Ù„Ù†Øµ',''));
      utter.lang = 'ar-SA';
      utter.rate = 0.95;
      utter.onend = ()=>{speaking=false; ttsBtn.textContent='ğŸ”Š Ø§Ø³ØªÙ…Ø¹ Ø¥Ù„Ù‰ Ø§Ù„Ù†Øµ'};
      speaking = true; ttsBtn.textContent='â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©';
      synth.speak(utter);
    });

    // Ø¥Ø®ÙØ§Ø¡/Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ´ÙƒÙŠÙ„
    const vowelsBtn = document.getElementById('vowelsBtn');
    let vowelsHidden = false;
    vowelsBtn.addEventListener('click', ()=>{
      const el = document.getElementById('text');
      if(!vowelsHidden){
        el.dataset.src = el.innerHTML;
        el.innerHTML = el.innerHTML.replace(/[\u064B-\u0652]/g,'');
      }else{
        el.innerHTML = el.dataset.src;
      }
      vowelsHidden = !vowelsHidden;
    });

    // Ø·Ø¨Ø§Ø¹Ø©
    document.getElementById('printBtn').addEventListener('click', ()=>window.print());

    // ÙØ§Ø¦Ø¯Ø©: ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¹Ø±Ø¨ÙŠ
    function normalizeArabic(s){
      return (s||'').trim()
        .replace(/[Ø£Ø¥Ø¢]/g,'Ø§')
        .replace(/Ù‰/g,'ÙŠ')
        .replace(/Ø©/g,'Ù‡')
        .replace(/[\u064B-\u0652]/g,'') // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ´ÙƒÙŠÙ„
        .replace(/\s+/g,' ')
        .toLowerCase();
    }
  </script>
</body>
</html>